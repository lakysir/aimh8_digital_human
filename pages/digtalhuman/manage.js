"use strict";const e=require("../../common/vendor.js"),t={__name:"manage",setup(t){const n=e.index.getStorageSync("phoneNum"),o=e.index.getStorageSync("user_id"),i=e.ref([]),a=async()=>{try{const t=await e.index.request({url:"https://www.aimh8.com/wechat_index.php",method:"POST",data:{getSelfRequestVideos:!0,username:n,user_id:o}});console.log(t),t.data.code>=0?i.value=t.data.muban_list.map((e=>({id:e[0],title:e[1]||"",doctor:e[8][1]||"",operator:e[9][1]||"",uploadtime:e[7]||"",video_url:e[2],check_status:e[6],accept_time:e[4],train_finish_time:e[5]}))):e.index.showToast({title:"获取视频列表失败",icon:"none"})}catch(t){console.error("获取数据失败：",t),e.index.showToast({title:"获取数据失败",icon:"none"})}};e.onMounted((()=>{e.index.showLoading({title:"加载中...",mask:!0}),a(),e.index.hideLoading()}));const s=e=>e.train_finish_time?"已发布":e.accept_time?"训练中":2==e.check_status?"待训练":0==e.check_status?"待审":1==e.check_status?"未过审":"",d=e=>{const t=s(e);return{"status-pending":"待训练"===t||"待审"===t,"status-rejected":"未过审"===t,"status-training":"训练中"===t,"status-published":"已发布"===t}},c=e=>{const t=s(e);return"待审"===t||"未过审"===t};return(t,r)=>({a:e.f(i.value,((t,i,r)=>e.e({a:e.t(t.doctor),b:e.t(t.operator),c:e.t(t.uploadtime),d:e.t(s(t)),e:e.n(d(t)),f:c(t)},c(t)?{g:e.o((i=>(t=>{e.index.showModal({title:"提示",content:"是否撤销本申请，撤销后将删除这条记录",success:async i=>{if(i.confirm){e.index.showLoading({title:"撤销中...",mask:!0});try{const i=await e.index.request({url:"https://www.aimh8.com/wechat_index.php",method:"POST",data:{deleteMubanRequest:!0,username:n,user_id:o,muban_id:t.id}});e.index.hideLoading(),console.log(i.data),i.data.code>=0&&(e.index.showToast({title:"撤销成功",icon:"success"}),a())}catch(s){e.index.hideLoading(),e.index.showToast({title:"撤销失败",icon:"none"})}}}})})(t)),i)}:{},{h:i,i:e.o((n=>(t=>{e.index.navigateTo({url:`/pages/video/play?videoUrl=${encodeURIComponent(t.video_url)}`})})(t)),i)})))})}};wx.createPage(t);
